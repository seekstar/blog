---
title: ZXV10-B860AV2.1刷Armbian
date: 2023-02-23 20:35:40
tags:
---

机器信息：

ZXV10-B860AV2.1
CPU: S905L 4核
RAM: 1G
eMMC: 8G

主要思路：先刷一个带root而且可以安装sd卡应用的Android系统，然后从SD卡安装reboot to libreELEC，通过它启动到U盘里的Armbian，然后在Armbian的shell里把Armbian刷到eMMC里。

网上教程很多，这里主要提一些坑点。一些文件从哪来的不记得了，这里只给文件名。

## 挑选Android镜像

对镜像的要求：带root，可以安装sd卡应用。但是有些系统不能通过reboot to libreELEC 启动到U盘，只能一个一个去试。

这个是我最终成功的镜像名称：`20191218-R3300L-Q7-6.0-root-twrp-Milton`

其他尝试失败的镜像：

- `201908-ZTE-b860aV2.1_1.1T-android4.42-root-qlzy`
要刷flash和boot loader，不然开机界面卡死。带root，可以安装sd卡应用。但是无法通过reboot to libreELEC启动到U盘。可能是因为系统和reboot to libreELEC不兼容，reboot to libreELEC无法请求root权限。

- `b860av2.1-20201215`
没有root。而且没法安装U盘里的应用。

- `android_tv_mgv2000-s905l2-android4.4.2-root`

来自这篇博客：[ZTE B860AV2.1 折腾 Armbian](https://blog.huggy.moe/posts/2022/15-b860av2.1-armbian/)

卡7%

- `newExt3-2020-12.img`

可以启动。但是没有root。

- `ZTE-B860AV1.1T-2020-12-15.img`

可以启动，有root，可以从U盘安装应用。但是无法通过reboot to libreELEC启动到U盘。

## 刷系统各个步骤的先后顺序

先点击开始，再短接C125，再上电。

## Armbian镜像

主要参考这篇博客：[ZTE B860AV2.1 折腾 Armbian](https://blog.huggy.moe/posts/2022/15-b860av2.1-armbian/)

我用的镜像：`Armbian_20.10-buster-b860-5.9.0.img`

先刷到U盘里，然后进行一些配置：

```shell
cp u-boot-s905x-s912 u-boot.ext
wget https://blog.huggy.moe/attachment/2022/15/meson-gxl-s905x-p212.dtb
```

然后在`extlinux/extlinux.conf`里：

```text
FDT /meson-gxl-s905x-p212.dtb
```

虽然进系统之后sudo有问题，但是可以修。

## 修复网络问题

默认的DNS设置有问题：

```shell
$ cat /etc/resolv.conf
nameserver 1.0.0.1
```

我们可以强制更新这个文件：<https://serverfault.com/questions/690559/how-do-i-force-networkmanager-to-update-etc-resolv-conf>

```shell
nmcli connection up eth0
```

然后DNS设置就正常了：

```shell
$ cat /etc/resolv.conf
# Generated by NetworkManager
nameserver 192.168.1.1
nameserver fe80::1%eth0
```

## 升级Debian 10到Debian 11

`/etc/apt/sources.list`:

```text
deb http://mirrors.tuna.tsinghua.edu.cn/debian bullseye main contrib non-free
deb http://mirrors.tuna.tsinghua.edu.cn/debian bullseye-updates main contrib non-free
deb http://mirrors.tuna.tsinghua.edu.cn/debian bullseye-backports main contrib non-free
deb https://mirrors.tuna.tsinghua.edu.cn/debian-security bullseye-security main contrib non-free
```

`/etc/apt/sources.list.d/armbian.list`:

```text
deb https://mirrors.tuna.tsinghua.edu.cn/armbian bullseye main bullseye-utils bullseye-desktop
```

```shell
# https://linuxize.com/post/how-to-upgrade-debian-10-to-debian-11/
apt update
apt full-upgrade
```

## 修复sudo

```shell
chmod +s /usr/bin/sudo
chown root:root -R /etc/sudoers.d/
chmod 700 -R /var/lib/sudo/lectured/
```

## 升级Debian 11到Debian 12

`/etc/apt/sources.list`:

```text
deb http://mirrors.tuna.tsinghua.edu.cn/debian bookworm main contrib non-free
deb http://mirrors.tuna.tsinghua.edu.cn/debian bookworm-updates main contrib non-free
deb http://mirrors.tuna.tsinghua.edu.cn/debian bookworm-backports main contrib non-free
deb https://mirrors.tuna.tsinghua.edu.cn/debian-security bookworm-security main contrib non-free
```

`/etc/apt/sources.list.d/armbian.list`:

```text
deb https://mirrors.tuna.tsinghua.edu.cn/armbian bookworm main bookworm-utils bookworm-desktop
```

可能需要把`armbian-config.list`删掉，不然`apt update`可能会报未签名的错。反正里面的`armbian-config`大概用不上：

```shell
sudo mv armbian-config.list /root/armbian-config.list-$(date +%s%N)
```

然后就可以更新了（可能会断网，最好在tmux里跑）：

```shell
sudo apt update
sudo apt dist-upgrade
```

## 升级Debian 12到Debian 13

`/etc/apt/sources.list`:

```text
deb http://mirrors.tuna.tsinghua.edu.cn/debian trixie main contrib non-free non-free-firmware
deb http://mirrors.tuna.tsinghua.edu.cn/debian trixie-updates main contrib non-free non-free-firmware
deb http://mirrors.tuna.tsinghua.edu.cn/debian trixie-backports main contrib non-free non-free-firmware
deb https://mirrors.tuna.tsinghua.edu.cn/debian-security trixie-security main contrib non-free non-free-firmware
```

`/etc/apt/sources.list.d/armbian.list`:

```text
deb https://mirrors.tuna.tsinghua.edu.cn/armbian trixie main trixie-utils trixie-desktop
```

然后就可以更新了（可能会断网，最好在tmux里跑）：

```shell
sudo apt update
sudo apt dist-upgrade
```
